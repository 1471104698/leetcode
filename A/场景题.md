# 场景题



## 大数据

1TB的文件里面全是IPv4地址，单机怎么找到出现次数top10的ip地址。如果这个文件全部能装入内存，最多会占多少内存

```
将 1TB 文件分成 100 个文件，每个文件找 TOP 10
然后将每个文件的 TOP 10 合并起来，再找 TOP 10

装入内存这个就不知道了
```



100万个ip地址，如何存这些ip地址，需要加入ip地址及判断ip地址是否存在，如何做

```
每个 ip 地址都是 32 位，那么直接转换为 int 型作为索引
然后使用一个 bitmap，在对应的索引位置处置 1 表示存在

加入 ip 地址就直接转换为 int 索引，在对应的 bitmap 处置 1
判断就直接判断对应的索引位置是否为 1
```



有一个大文件有用户的登录信息，文件包含10亿条目，文件格式，uid，login_time，logout_time，编写一个函数，获得一天内登录的峰值人数

```
精确到秒的话，只需要开辟一个 24 * 60 * 60 的数组，记录对应的时间点的人数即可
```



1TB 文件，里面每条记录都存在一个时间戳 和 数据，怎么找出在给定 时间范围内的所有数据

```
方法一：分为多个文件，对每个文件按照时间戳进行排序，然后二分查找获取每个文件中在 时间范围内的数据

方法二：O(n) 扫描一遍文件，获取时间戳中最小的时间 min 和最大的时间 max，跨度为 max - min，这样的话，假设跨度为 1000，那么按照 30 天之类的分为一个文件，比如 第 min 天到 第 min + 30 天的数据划分为一个文件
这样的话，当我们查找的时间跨度为 100 时，假设中间的 90 天是定在了 3 个文件中的，而有 5 天是在左相邻的一个文件中的，另外 5 天是在右相邻的文件中的，这样的话我们需要可以直接获取中间 3 个文件（90天）的所有数据，然后再对左右两边两个文件进行二分查找对应剩下的 10 天数据，高效
```



## 字符串加减法

字符串加法：正整数

```
直接计算即可
```

字符串加法：小数

```java
计算出 a 和 b 的两个的小数个数（indexOf(".")），当然需要先判断是否存在 "."
如果两个都是整数，那么直接运算
如果一个是整数或者两个都是小数，那么按照最长的小数长度对另一个进行补齐 0
比如 a = "1.2", b = "2.1234"
那么补齐后变成 a = "1.2000", b = "2.1234"
然后直接进行运算

    private void h(String a, String b){
        //进行小数点填充
        int point1 = a.indexOf(".");
        int point2 = b.indexOf(".");
        //小数长度
        int l1 = a.length() - point1 - 1;
        int l2 = b.length() - point2 - 1;
        //填充小数后面的 0
        if(point1 != -1 && point2 != -1){
            if(l1 > l2){
                b = addZero(l1 - l2, new StringBuilder(b));
            }else{
                a = addZero(l2 - l1, new StringBuilder(a));
            }
        }else if(point1 != -1){
            b = addZero(l1, new StringBuilder(b).append("."));
        }else if(point2 != -1){
            a = addZero(l2, new StringBuilder(a).append("."));
        }
        add(a, b);
    }
    private String addZero(int diff, StringBuilder sb){
        while(diff-- > 0){
            sb.append(0);
        }
        return sb.toString();
    }
    private void add(String a, String b){
        StringBuilder sb = new StringBuilder();
        int len1 = a.length();
        int len2 = b.length();

        int cin = 0;
        for(int i = len1 - 1, j = len2 - 1; i >= 0 || j >= 0; i--, j--){
            if(i >= 0 && a.charAt(i) == '.'){
                sb.append(".");
                continue;
            }
            int n1 = i >= 0 ? a.charAt(i) - '0' : 0;
            int n2 = j >= 0 ? b.charAt(j) - '0' : 0;
            int sum = n1 + n2 + cin;
            sb.append(sum % 10);
            cin = sum / 10;
        }
        if(cin == 1){
            sb.append(1);
        }
        System.out.println(sb.reverse().toString());
    }
```



字符串减法：

```java
先提取出符号位，然后判断都当作是正数的情况下哪个比较大，使用大的减去小的，这时候使用 int[] 来接受每一位的结果
然后从后往前判断 int[] 每一位的结果，如果 res[i + 1] < 0，那么向 res[i] 借位
即 res[i + 1] += 10, res[i]--

最终将返回的结果添加符号位
```





# 逻辑题



## 蓝眼睛 和 红眼睛

```
岛上 100 个人， 3 个蓝眼睛， 97 个红眼睛， 他们不能看自己的眼睛，如果知道自己眼睛颜色后会在第二天自杀
某天岛上来了一个游客，他说" 岛上竟然有蓝眼睛的"，这句话会产生什么影响？

这句话看似没什么影响，但其实会给出一个重要的信息：

在最开始的时候，岛上的人不会去猜疑，因为他们都知道别人知道自己的眼睛颜色，而不自己不知道自己的眼睛颜色。
直到游客说了这么一句话
这样的话，他们就会陷入猜疑，比如 有两个蓝眼睛的 A 和 B
最开始在 A 眼里，岛上只有一个蓝眼睛的 B，自己是红眼睛的，那么对于 B 来说，没有发现别的蓝眼睛的，那么他就会意识到自己是蓝眼睛的，那么在第二天就会自杀
最开始在 B 眼里，岛上只有一个蓝眼睛的 A，自己是红眼睛的，那么对于 A 来说，没有发现别的蓝眼睛的，那么他就会意识到自己是蓝眼睛的，那么在第二天就会自杀
但是，如果第二天 A 发现 B 没有自杀，B 发现 A 没有自杀，那么 B 就知道了在 A 的视角里还存在一个蓝眼睛，A 就知道了在 B 的视角里还存在一个蓝眼睛，因此他们都会知道是自己了，那么他们在第三天就会自杀

如果蓝眼睛的有三个人
假设 蓝眼睛的人为 A B C
A 知道 B 和 C 知道这个岛上有蓝眼睛的
B 知道 A 和 C 知道这个岛上有蓝眼睛的
C 知道 A 和 B 知道这个岛上有蓝眼睛的
而 A 和 B 和 C 都不知道自己的眼睛颜色，因此它们会通过推理，但会在遵守教义的情况下能活就活，不会随便寻死

A 能够看到 B 和 C 的眼睛，因此知道岛上至少有 2 个蓝眼睛的人
并且这时候他不认为自己是蓝眼睛的
B 能够看到 A 和 C 的眼睛，因此知道岛上至少有 2 个蓝眼睛的人
并且这时候他不认为自己是蓝眼睛的
C 能够看到 A 和 B 的眼睛，因此知道岛上至少有 2 个蓝眼睛的人
并且这时候他不认为自己是蓝眼睛的

因此今天过后，第二天，他们都不会自杀，因为它们认为有蓝眼睛的人不会是自己

第二天，A 和 B 和 C 清楚的知道不会有人自杀
A 知道存在两个蓝眼睛的人， B 会看到 C 是蓝眼睛的，所以不会认为自己是蓝眼睛的，C 也一样，所以在今天不会自杀，所以 A 还是认为自己不是蓝眼睛
B 知道存在两个蓝眼睛的人， A 会看到 C 是蓝眼睛的，所以不会认为自己是蓝眼睛的，C 也一样，所以在今天不会自杀，所以 B 还是认为自己不是蓝眼睛
C 知道存在两个蓝眼睛的人， A 会看到 B 是蓝眼睛的，所以不会认为自己是蓝眼睛的，C 也一样，所以在今天不会自杀，所以 C 还是认为自己不是蓝眼睛

第三天，A 和 B 和 C 知道今天是决定命运的一天
因为 A 知道存在两个蓝眼睛的人 B 和 C，在第一天中，A 认为自己不是蓝眼睛的，这样的话他认为 B 和 C 都会互相看，他们各自都会看到对方的蓝眼睛，因此不会认为自己就是蓝眼睛，直到等到第二天没有人自杀，因此他们就会发现自己是蓝眼睛的，因此会在第三天自杀，而如果在第三天没有人自杀的话，那 A 发现岛上除了 自己看到的 两个蓝眼睛，其他的都是红眼睛，这样的话如果自己不是蓝眼睛，那么他们在今天就会自杀了，但是如果没有自杀，表示在他们眼里第二天存在两个蓝眼睛的，因此会等到第三天看是否有人自杀，那么 A 就会意识到自己就是蓝眼睛的
同理 B 和 C 也一样
因此，他们在第三天都知道了自己的眼睛是蓝眼睛的，所以会在第四天自杀

而在第四天，棕色眼睛的人发现蓝眼睛的全部都死了，这样的话表示蓝眼睛的猜疑链就结束了，这样的话剩下的都是棕色眼睛的，表示大家都知道自己是棕色眼睛的了，那么就会在第五天集体自杀
```





## 赛马 找出 TOP K