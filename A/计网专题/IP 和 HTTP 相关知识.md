# IP 和 基础知识



# 1、前置了解知识

---



## 1、网络层（IP） 和 数据链路层（MAC） 的关系

**MAC 的作用则是实现「直连」的两个设备之间通信，而 IP 则负责在「没有直连」的两个网络之间进行通信传输。**



>  举个例子

IP 我们可以当作是一个人的姓名，而 MAC 可以当作是一个人的居住地址

当送快递的时候，如果仅仅知道 IP，而不知道 MAC，那么就无法将快递送出去

快递公司会将快递从某个转接站送到某个转接站，一站过一站，直到到达目的 IP

而 这些转接的站点就是 MAC 地址



快递传送途中虽然不断变化了站点位置，但是起始地址和目的地址始终都没变。

其实，在网络中数据包传输中也是如此，**源IP地址和目标IP地址在传输过程中是不会变化的，只有源 MAC 地址和目标 MAC 一直在变化。**



## 2、IP地址划分

首先，最基础的当然就是 IP 地址是怎么划分的啦

首先我们需要知道 IP 地址的数量

以 IPv4 为例，每个 IP 由 32 位二进制组成，这里没有负数的概念，因此总的有 42 亿 IP 地址

*![image.png](https://pic.leetcode-cn.com/1598011080-gucfqx-image.png)*



常用划分为 A、B、C 类

各类的网络号和主机号位数不同，因为都是 32 位，因此网络号位数多的主机号位数就少

划分出网络号的目的是为了方便数据传输，路由器可以根据 IP 目的地址的网络号 确定是哪个网络段的来进行传输

*![image.png](https://pic.leetcode-cn.com/1598011098-zyTTOy-image.png)*

*![image.png](https://pic.leetcode-cn.com/1598010654-jidKYZ-image.png)*



一般我们自己电脑下的就是 C 类地址，以 192.x.x.x 的

*![image.png](https://pic.leetcode-cn.com/1598011333-DtpXyL-image.png)*



## 3、划分子网 - 子网掩码

**就比如我们上面说的，为什么要划分出网络号和主机号，网络号的作用是什么？**

两台计算机要通信，首先要判断是否在同一个网络段，如果是，那么直接发送数据包到目的主机，如果不是，那么通过 路由器寻址，通过网络号来寻找对应的网络段位置

![1598011512649](C:\Users\蒜头王八\AppData\Roaming\Typora\typora-user-images\1598011512649.png)



#### **子网掩码：**

掩码的意思就是掩盖掉主机号，剩余的就是网络号，即将主机号和网络号进行分离

由于我们要掩盖掉主机号来留下网络号，因此，对于 C 类地址，号码 8 位都是主机号

因此，子网掩码为 255.255.255.0，这样按位与操作后，主机号就都变成 0 了，而 网络号不变

*![image.png](https://pic.leetcode-cn.com/1598011628-yKmTMc-image.png)*



同样的，如果是 B 类地址，那么后 16 位为主机号，那么子网掩码为 255.255.0.0





## 4、DNS

使用域名的主要原因就是方便用户记忆，不然你每次都输入一串 IP 地址去访问，这样多麻烦

输入 访问 url 后，需要先通过 DNS 域名解析，获取到 目的 IP 地址，才能进行 TCP/UDP 通信

 

由于域名是国外发明的，而国外的习惯跟我们不同，  习惯从小到大，而我们习惯从大到小

外国喜欢从小到大的方式顺序说起（如 XX 街道 XX 区 XX 市 XX 省）

而中国则喜欢从大到小的顺序（如 XX 省 XX 市 XX 区 XX 街道）。



因此域名也是如此，比如 www.server.com。 一般我们认为前面的是大的，但是根据外国的习惯

com 是最高级的，server.com 次之

因此存在以下关系：

- 根 DNS 服务器
- 顶级域 DNS 服务器（com）
- 权威 DNS 服务器（server.com）

*![image.png](https://pic.leetcode-cn.com/1598012011-dUDkmu-image.png)*



com 是由顶级域 DNS 服务器管理的，不是由 根DNS 服务器管理的

根 DNS 服务器最高级，每台 DNS 服务器中都有记录 根域 DNS 服务器

同样的，根域 DNS 服务器 也记录了所有 的 DNS 服务器，这样其他 DNS 服务器可以通过访问 根域 DNS 服务器 来获取其他 DNS 服务器的位置



#### **域名解析的工作流程**

当我们输入 url 后，浏览器会看自己缓存中是否存在 域名对应的 IP 地址，如果没有，那么找操作系统缓存要，如果没有，那么找本地 host 文件要，如果还没有，那么就会通过 DNS 服务器查询，具体过程如下：

- 客户端首先会发送一个 DNS 请求给本地 DNS 服务器（点开网络配置可以看到，一般我们是不会配置的，是默认的 DNS 服务器，具体可以看 IP 地址划分那张图，或者自己点开网络配置看），问 www.server.com  的 IP 地址是什么
- 本地 DNS 服务器获取到请求后，如果自己有记录，那么将 IP 地址返回，如果没有，那么找到自己记录的     根 DNS 服务器，询问对应的 IP 地址，“老大， 能告诉我 www.server.com 的 IP 地址吗？”  
- 需要注意的是，根DNS 服务器 并不参与域名解析，但是我们上面说了，根DNS 服务器 存储了所有 DNS 服务器，因此它可以查询出管理 com 的 DNS 服务器，将地址发给 本地 DNS 服务器，（不参与解析，但会指明一条道路）
- 本地 DNS 服务器获取到管理 com 的顶级域名服务器的地址后，发起请问问它：“老二， 你能告诉我 www.server.com  的 IP 地址吗？”
- 顶级域名服务器会告诉 本地 DNS 服务器 管理 server.com 的权威域名服务器地址
- 本地 DNS 获取 权威域名服务器地址，发起请求问：“老三，www.server.com对应的IP是啥呀？”
- 权威 DNS 服务器查询后将对应的 IP 地址 X.X.X.X 告诉本地 DNS。
- 本地 DNS 再将 IP 地址返回客户端，客户端和目标建立连接。

#### ![1598012683746](C:\Users\蒜头王八\AppData\Roaming\Typora\typora-user-images\1598012683746.png)





## 5、ARP 协议

当 ip1 ping ip2 的时候，我们只知道对方主机的 ip ，但是不知道目的 MAC 地址，相当于快递只知道姓名，不知道地址一样，那么我们需要获取地址

通过 ARP 协议可以获取地址，先广播，发送 ARP 请求给 与 目的 ip 同个子网的所有设备，当它们收到这个 ARP 请求时，会拆开，如果内部要求的 ip 地址跟自己相似，那么就将自己的 MAC 地址放到 ARP 响应返回，如果不是，那么直接舍弃

当 ip1 的主机获取了 目的主机的 MAC 地址后，会将 它存储起来，方便下次直接获取（不过是存在期限的）

就一步步从自己身边的 MAC 出发，跳到目的 MAC





# 2、面试问题

---



## 1、get 和 post 的区别

首先应该先搞清楚 get 和 post 是什么

get 是 **从服务器获取资源**，而 post 是 **向指定的 url 提交数据**

get 的资源可以是文本、图片、视频等，比如我们打开一篇文章，就是发送 get 请求给服务器，然后返回文章的内容

post 则是我们在一篇文章下面评论，就是通过 post 请求将评论内容作为数据，通过 TCP 协议传输给服务器



> GET 和 POST 方法都是安全和幂等的吗？

先说下安全和幂等的概念

- 安全是指方法请求不会 破坏 和 改变 服务器上的资源
- 幂等是指无论请求多少次，结果都是相同的（无论是查询还是别的）

通过上面这个概念，就可以看出来了，get 是安全和幂等的，因为 get 仅仅是查询

而 post 不是，因为 会新增 和 更新资源，会改变服务器上的资源，所以是不安全的，而多次提交会创建多个相同资源，因为 post 可能是更新或者删除或者插入





## 2、一次HTTP的完整请求过程（输入一个 url 的过程，后面还需要进行补充，详细讲解）

通过 DNS 进行域名解析，获取 ip 地址

通过 ARP 协议 / 缓存 获取对应的 MAC 地址

TCP 协议三次握手

服务器接收 http get 请求，返回 http 资源

浏览器解析 http 资源



## 3、HTTP 常见的状态码 

## ![img](https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZfXG1113Sjm0iaOXfoOv0tlUfV6qkzg4yHtOibAfTv6hTicOx73F55WWl4nW2FWlXnDJ7Igd9kvrrRnA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1) 



**1xx**

提示信息，中间状态，比如我转账给你，钱转过去需要一段处理时间，这段时间可以理解为 1xx



**2xx**

成功状态码，我们最愿意看到的

 「**200 OK**」是最常见的成功状态码，表示一切正常 ，可能服务器返回的 body 中会有数据

 「**204 No Content**」 也是是最常见的成功状态码，服务器不会返回数据

 「**206 Partial Content**」是 **应用于 HTTP 分块下载 或 断电续传**，表示响应返回的 body 数据并不是资源的全部，而是其中的一部分，也是服务器处理成功的状态。 



**3xx**

表示用户请求的资源位置发生了改变，告知用户需要向新的 URL 发送请求（即旧的 URL 不再提供服务）

 「**301 Moved Permanently**」表示永久重定向，说明请求的资源已经不存在了，需改用新的 URL 再次访问。 

 「**302 Moved Permanently**」表示临时重定向，说明请求的资源还在，但暂时需要用另一个 URL 来访问。

上面这两个服务器会将新的 URL 一同返回，客户端自动进行访问

 「**304 Not Modified**」表示资源未修改，发送 get 方法请求资源的时候，服务器告知资源未修改，直接用原来的缓存就行了



2xx 和 3xx 都跟错误搭不上边，错误是指 客户端 或 服务端 某方面的错误



**4xx**

客户端方面的错误，服务端不能处理

 「**400 Bad Request**」表示客户端请求的报文有错误，笼统的错误，即并不知道什么错误

 「**403 Forbidden**」表示服务器禁止访问资源，即客户端访问了不能访问的资源

 「**404 Not Found**」表示请求的资源在服务器上不存在或未找到，所以无法提供给客户端。 



**5xx**

客户端方面没有错误，而是服务端内部出现 了错误

 「**500 Internal Server Error**」与 400 类型，是个笼统通用的错误码，服务器发生了什么错误，我们并不知道。 

 「**501 Not Implemented**」表示客户端请求的功能还不支持，服务端无法处理，类似“即将开业，敬请期待”的意思。

 「**502 Bad Gateway**」通常是服务器作为网关或代理时返回的错误码，表示服务器自身工作正常，访问后端服务器发生了错误。 

 「**503 Service Unavailable**」表示服务器当前很忙，暂时无法响应服务器，高并发下可能就有这样的返回码，类似“网络服务正忙，请稍后重试”的意思。 



**上面列举的是常见的状态码，一些不常见的就没列举了，比如 303，401，402 之类的**



## 4、HTTP 说是无状态的，那么是怎么记录状态的呢？

无状态产生的问题：

既然服务器没有记忆能力，它在完成有关联性的操作时会非常麻烦 



解决：

通过 cookie 技术，客户端除了第一次访问外，每次访问都携带 cookie，里面存储了自己的信息，只要服务端内部有 对应的 `JsessionId` 的话，就无需用户再次进行登录

